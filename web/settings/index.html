<!-- settings/index.html -->
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quan Ly Bot - Settings</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
<!-- Sidebar Navigation -->
<div class="sidebar">
    <div class="logo-details">
        <i class="bx bxl-c-plus-plus icon"></i>
        <div class="logo_name">Bot Manager</div>
        <i class="bx bx-menu" id="btn"></i>
    </div>
    <ul class="nav-list">
        <li>
            <i class="bx bx-search"></i>
            <input type="text" placeholder="Search..." />
            <span class="tooltip">Search</span>
        </li>
        <li>
            <a href="/home/">
                <i class="bx bx-grid-alt"></i>
                <span class="links_name">Home</span>
            </a>
            <span class="tooltip">Home</span>
        </li>
        <li>
            <a href="/manager/" data-require-login="true">
                <i class="bx bx-cog"></i>
                <span class="links_name">Manager</span>
            </a>
            <span class="tooltip">Manager</span>
        </li>
        <li>
            <a href="/bots/" data-require-login="true">
                <i class="bx bxs-bot"></i>
                <span class="links_name">Bot</span>
            </a>
            <span class="tooltip">Bot</span>
        </li>
        <li>
            <a href="/create/" data-require-login="true">
                <i class="bx bx-plus"></i>
                <span class="links_name">Create</span>
            </a>
            <span class="tooltip">Create</span>
        </li>
        <li>
            <a href="/rental/" data-require-login="true">
                <i class="bx bx-money"></i>
                <span class="links_name">Rental</span>
            </a>
            <span class="tooltip">Rental</span>
        </li>
        <li>
            <a href="/commands/" data-require-login="true">
                <i class="bx bx-command"></i>
                <span class="links_name">Commands</span>
            </a>
            <span class="tooltip">Commands</span>
        </li>
        <li>
            <a href="/statistics/" data-require-login="true">
                <i class="bx bx-pie-chart-alt-2"></i>
                <span class="links_name">Statistics</span>
            </a>
            <span class="tooltip">Statistics</span>
        </li>
        <li>
            <a href="/users/" data-require-login="true">
                <i class="bx bx-user"></i>
                <span class="links_name">Users</span>
            </a>
            <span class="tooltip">Users</span>
        </li>
        <li>
            <a href="/history/" data-require-login="true">
                <i class="bx bx-history"></i>
                <span class="links_name">History</span>
            </a>
            <span class="tooltip">History</span>
        </li>
        <li>
            <a href="/settings/" data-require-login="true">
                <i class="bx bx-slider"></i>
                <span class="links_name">Settings</span>
            </a>
            <span class="tooltip">Settings</span>
        </li>
        <li>
            <a href="/theme/" data-require-login="true">
                <i class="bx bx-palette"></i>
                <span class="links_name">Theme</span>
            </a>
            <span class="tooltip">Theme</span>
        </li>
        <li>
            <a href="#" id="theme-toggle-sidebar">
                <i class="bx bx-moon"></i>
                <span class="links_name">Theme</span>
            </a>
            <span class="tooltip">Toggle Theme</span>
        </li>
        <li id="auth-buttons" style="display: none;">
            <a href="/login/">
                <i class="bx bx-log-in"></i>
                <span class="links_name">Login</span>
            </a>
            <span class="tooltip">Login</span>
        </li>
        <li id="register-button" style="display: none;">
            <a href="/register/">
                <i class="bx bx-user-plus"></i>
                <span class="links_name">Register</span>
            </a>
            <span class="tooltip">Register</span>
        </li>
        <li class="profile" id="user-profile">
            <div class="profile-details">
                <img src="/profile.jpg" alt="profileImg" />
                <div class="name_job">
                    <div class="name" id="profile-name">User</div>
                    <div class="job">Web Manager</div>
                </div>
            </div>
            <i class="bx bx-log-out" id="logout-btn"></i>
        </li>
    </ul>
</div>

<section class="home-section">
    <div class="page active" id="settings-page">
        <div class="home-container">
            <div class="settings-card">
                <h2 class="page-title">‚öôÔ∏è C√†i ƒê·∫∑t H·ªá Th·ªëng</h2>
                <p style="text-align: center; color: #6b7280; margin-bottom: 30px;">Qu·∫£n l√Ω c·∫•u h√¨nh v√† t√πy ch·ªânh h·ªá th·ªëng</p>
                
                <!-- General Settings Section -->
                <div class="settings-section">
                    <h3 class="settings-section-title">üîß C√†i ƒê·∫∑t Chung</h3>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">T√™n ·ª©ng d·ª•ng</div>
                            <div class="setting-desc">T√™n hi·ªÉn th·ªã c·ªßa ·ª©ng d·ª•ng</div>
                        </div>
                        <input type="text" class="setting-input" id="app-name" value="Bot Manager" />
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">Ng√¥n ng·ªØ</div>
                            <div class="setting-desc">Ch·ªçn ng√¥n ng·ªØ hi·ªÉn th·ªã</div>
                        </div>
                        <select class="setting-select" id="language">
                            <option value="vi" selected>Ti·∫øng Vi·ªát</option>
                            <option value="en">English</option>
                            <option value="ja">Êó•Êú¨Ë™û</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">M√∫i gi·ªù</div>
                            <div class="setting-desc">Ch·ªçn m√∫i gi·ªù c·ªßa b·∫°n</div>
                        </div>
                        <select class="setting-select" id="timezone">
                            <option value="Asia/Ho_Chi_Minh" selected>GMT+7 (Vi·ªát Nam)</option>
                            <option value="Asia/Tokyo">GMT+9 (Tokyo)</option>
                            <option value="America/New_York">GMT-5 (New York)</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">T·ª± ƒë·ªông c·∫≠p nh·∫≠t</div>
                            <div class="setting-desc">T·ª± ƒë·ªông c·∫≠p nh·∫≠t khi c√≥ phi√™n b·∫£n m·ªõi</div>
                        </div>
                        <div class="toggle-switch active" id="auto-update">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">B√°o c√°o l·ªói t·ª± ƒë·ªông</div>
                            <div class="setting-desc">G·ª≠i b√°o c√°o l·ªói ƒë·ªÉ c·∫£i thi·ªán ch·∫•t l∆∞·ª£ng</div>
                        </div>
                        <div class="toggle-switch active" id="error-report">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>

                <!-- Notification Settings Section -->
                <div class="settings-section">
                    <h3 class="settings-section-title">üîî Th√¥ng B√°o</h3>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">Th√¥ng b√°o Email</div>
                            <div class="setting-desc">Nh·∫≠n th√¥ng b√°o qua email</div>
                        </div>
                        <div class="toggle-switch active" id="email-notify">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">Th√¥ng b√°o Zalo</div>
                            <div class="setting-desc">Nh·∫≠n th√¥ng b√°o qua Zalo</div>
                        </div>
                        <div class="toggle-switch active" id="zalo-notify">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">Th√¥ng b√°o Bot offline</div>
                            <div class="setting-desc">C·∫£nh b√°o khi bot ng·ª´ng ho·∫°t ƒë·ªông</div>
                        </div>
                        <div class="toggle-switch active" id="bot-offline-notify">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">Th√¥ng b√°o thanh to√°n</div>
                            <div class="setting-desc">Th√¥ng b√°o v·ªÅ giao d·ªãch v√† thanh to√°n</div>
                        </div>
                        <div class="toggle-switch active" id="payment-notify">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>

                <!-- Security Settings Section -->
                <div class="settings-section">
                    <h3 class="settings-section-title">üîí B·∫£o M·∫≠t</h3>
                    
                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">ƒê·ªïi m·∫≠t kh·∫©u</div>
                            <div class="setting-desc">C·∫≠p nh·∫≠t m·∫≠t kh·∫©u ƒë·ªÉ b·∫£o v·ªá t√†i kho·∫£n</div>
                        </div>
                        <button class="btn btn-primary" id="change-password-btn" style="width: auto; padding: 8px 16px; margin: 0;">ƒê·ªïi</button>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">X√°c th·ª±c 2 b∆∞·ªõc</div>
                            <div class="setting-desc">TƒÉng c∆∞·ªùng b·∫£o m·∫≠t v·ªõi OTP</div>
                        </div>
                        <button class="btn btn-primary" id="enable-2fa-btn" style="width: auto; padding: 8px 16px; margin: 0;">B·∫≠t</button>
                    </div>

                    <div class="setting-item">
                        <div class="setting-label">
                            <div class="setting-name">ƒêƒÉng nh·∫≠p b·∫±ng sinh tr·∫Øc h·ªçc</div>
                            <div class="setting-desc">S·ª≠ d·ª•ng v√¢n tay ho·∫∑c Face ID</div>
                        </div>
                        <div class="toggle-switch" id="biometric-login">
                            <div class="toggle-slider"></div>
                        </div>
                    </div>
                </div>

                <!-- Save Buttons -->
                <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 30px;">
                    <button class="btn btn-warning" id="reset-settings-btn" style="width: auto; padding: 12px 24px;">
                        üîÑ ƒê·∫∑t l·∫°i m·∫∑c ƒë·ªãnh
                    </button>
                    <button class="btn btn-success" id="save-settings-btn" style="width: auto; padding: 12px 24px;">
                        üíæ L∆∞u thay ƒë·ªïi
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Boxicons CDN Link -->
<link href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css" rel="stylesheet" />
<script src="/sidebar.js"></script>
<script src="/script.js"></script>

<script>
$(document).ready(function() {
    // Check login
    function checkLogin() {
        $.ajax({
            url: '/api/auth/me',
            method: 'GET',
            error: function() {
                alert('‚ö†Ô∏è B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ truy c·∫≠p c√†i ƒë·∫∑t!');
                window.location.href = '/login/';
            }
        });
    }
    
    // Toggle switches
    $('.toggle-switch').click(function() {
        $(this).toggleClass('active');
    });
    
    // Change password
    $('#change-password-btn').click(function() {
        const oldPassword = prompt('Nh·∫≠p m·∫≠t kh·∫©u hi·ªán t·∫°i:');
        if (!oldPassword) return;

        const newPassword = prompt('Nh·∫≠p m·∫≠t kh·∫©u m·ªõi (t·ªëi thi·ªÉu 8 k√Ω t·ª±):');
        if (!newPassword) return;

        if (newPassword.length < 8) {
            alert('‚ö†Ô∏è M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 8 k√Ω t·ª±!');
            return;
        }

        const confirmPassword = prompt('X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi:');
        if (newPassword !== confirmPassword) {
            alert('‚ö†Ô∏è M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp!');
            return;
        }

        $.ajax({
            url: '/api/auth/change-password',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({
                old_password: oldPassword,
                new_password: newPassword
            }),
            success: function(response) {
                if (response.success) {
                    alert('‚úÖ ƒê√£ ƒë·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!\n\nVui l√≤ng ƒëƒÉng nh·∫≠p l·∫°i.');
                    window.location.href = '/login/';
                }
            },
            error: function(xhr) {
                const error = xhr.responseJSON?.error || 'Kh√¥ng th·ªÉ ƒë·ªïi m·∫≠t kh·∫©u';
                alert('‚ùå ' + error);
            }
        });
    });
    
    // Enable 2FA
    $('#enable-2fa-btn').click(function() {
        alert('üîê T√≠nh nƒÉng x√°c th·ª±c 2 b∆∞·ªõc ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn!');
    });
    
    // Save settings
    $('#save-settings-btn').click(function() {
        const $btn = $(this);
        const originalText = $btn.html();
        
        $btn.prop('disabled', true).html('‚è≥ ƒêang l∆∞u...');
        
        setTimeout(() => {
            $btn.prop('disabled', false).html(originalText);
            alert('‚úÖ ƒê√£ l∆∞u c√†i ƒë·∫∑t th√†nh c√¥ng!');
        }, 1000);
    });
    
    // Reset settings
    $('#reset-settings-btn').click(function() {
        if (confirm('‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc mu·ªën ƒë·∫∑t l·∫°i t·∫•t c·∫£ v·ªÅ m·∫∑c ƒë·ªãnh?')) {
            alert('‚úÖ ƒê√£ ƒë·∫∑t l·∫°i c√†i ƒë·∫∑t m·∫∑c ƒë·ªãnh!');
            location.reload();
        }
    });
    
    // Initialize
    checkLogin();
});
</script>
</body>
</html>